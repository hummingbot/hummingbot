{"version":3,"sources":["../../src/utils/print-deprecation-warnings.ts"],"names":["printDeprecationWarnings","deprecatedApis","fixMap","boundActionCreators","newName","docsLink","pathContext","deprecatedLocations","glob","sync","nodir","forEach","file","fileText","fs","readFileSync","matchingApis","filter","api","includes","push","length","console","log","chalk","cyan","yellow"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;AAEO,SAASA,wBAAT,GAA0C;AAC/C,QAAMC,cAAc,GAAG,CAAE,qBAAF,EAAyB,aAAzB,CAAvB;AACA,QAAMC,MAAM,GAAG;AACbC,IAAAA,mBAAmB,EAAE;AACnBC,MAAAA,OAAO,EAAG,SADS;AAEnBC,MAAAA,QAAQ,EAAG;AAFQ,KADR;AAKbC,IAAAA,WAAW,EAAE;AACXF,MAAAA,OAAO,EAAG,aADC;AAEXC,MAAAA,QAAQ,EAAG;AAFA;AALA,GAAf;AAUA,QAAME,mBAAkD,GAAG;AACzDJ,IAAAA,mBAAmB,EAAE,EADoC;AAEzDG,IAAAA,WAAW,EAAE;AAF4C,GAA3D;;AAKAE,gBACGC,IADH,CACS,mCADT,EAC6C;AAAEC,IAAAA,KAAK,EAAE;AAAT,GAD7C,EAEGC,OAFH,CAEWC,IAAI,IAAI;AACf,UAAMC,QAAQ,GAAGC,YAAGC,YAAH,CAAgBH,IAAhB,CAAjB;;AACA,UAAMI,YAAY,GAAGf,cAAc,CAACgB,MAAf,CAAsBC,GAAG,IAAIL,QAAQ,CAACM,QAAT,CAAkBD,GAAlB,CAA7B,CAArB;AACAF,IAAAA,YAAY,CAACL,OAAb,CAAqBO,GAAG,IAAIX,mBAAmB,CAACW,GAAD,CAAnB,CAAyBE,IAAzB,CAA8BR,IAA9B,CAA5B;AACD,GANH;;AAQAX,EAAAA,cAAc,CAACU,OAAf,CAAuBO,GAAG,IAAI;AAC5B,QAAIX,mBAAmB,CAACW,GAAD,CAAnB,CAAyBG,MAA7B,EAAqC;AACnCC,MAAAA,OAAO,CAACC,GAAR,CACG,aADH,EAEEC,eAAMC,IAAN,CAAWP,GAAX,CAFF,EAGEM,eAAME,MAAN,CAAc,2BAAd,CAHF,EAIEF,eAAMC,IAAN,CAAWvB,MAAM,CAACgB,GAAD,CAAN,CAAYd,OAAvB,CAJF,EAKEoB,eAAME,MAAN,CACG,4CAA2CxB,MAAM,CAACgB,GAAD,CAAN,CAAYb,QAAS,8BADnE,CALF;AASAiB,MAAAA,OAAO,CAACC,GAAR;AACAhB,MAAAA,mBAAmB,CAACW,GAAD,CAAnB,CAAyBP,OAAzB,CAAiCC,IAAI,IAAIU,OAAO,CAACC,GAAR,CAAYX,IAAZ,CAAzC;AACAU,MAAAA,OAAO,CAACC,GAAR;AACD;AACF,GAfD;AAgBD","sourcesContent":["import fs from \"fs\"\nimport glob from \"glob\"\nimport chalk from \"chalk\"\n\nexport function printDeprecationWarnings(): void {\n  const deprecatedApis = [`boundActionCreators`, `pathContext`]\n  const fixMap = {\n    boundActionCreators: {\n      newName: `actions`,\n      docsLink: `https://gatsby.dev/boundActionCreators`,\n    },\n    pathContext: {\n      newName: `pageContext`,\n      docsLink: `https://gatsby.dev/pathContext`,\n    },\n  }\n  const deprecatedLocations: Record<string, Array<string>> = {\n    boundActionCreators: [],\n    pathContext: [],\n  }\n\n  glob\n    .sync(`{,!(node_modules|public)/**/}*.js`, { nodir: true })\n    .forEach(file => {\n      const fileText = fs.readFileSync(file)\n      const matchingApis = deprecatedApis.filter(api => fileText.includes(api))\n      matchingApis.forEach(api => deprecatedLocations[api].push(file))\n    })\n\n  deprecatedApis.forEach(api => {\n    if (deprecatedLocations[api].length) {\n      console.log(\n        `%s %s %s %s`,\n        chalk.cyan(api),\n        chalk.yellow(`is deprecated. Please use`),\n        chalk.cyan(fixMap[api].newName),\n        chalk.yellow(\n          `instead. For migration instructions, see ${fixMap[api].docsLink}\\nCheck the following files:`\n        )\n      )\n      console.log()\n      deprecatedLocations[api].forEach(file => console.log(file))\n      console.log()\n    }\n  })\n}\n"],"file":"print-deprecation-warnings.js"}