{"version":3,"file":"index.js","sources":["../src/Menu/index.tsx"],"sourcesContent":["/* eslint-disable @typescript-eslint/no-empty-interface */\nimport React from \"react\";\nimport { AbstractTooltip } from \"../AbstractTooltip\";\nimport { TippyMenuStyles } from \"./menu/TippyMenuStyles\";\nimport { MenuConfigProvider, useMenuIconSize } from \"../MenuConfig\";\nimport {\n  MenuItemClickListenerProvider,\n  useMenuItemClickListener,\n} from \"../MenuItemClickListener\";\nimport { sizeModifier } from \"./menu/sizeModifier\";\nimport { ShadedColor } from \"../colors\";\n\ninterface Props\n  extends Pick<\n      React.ComponentProps<typeof AbstractTooltip>,\n      | \"children\"\n      | \"content\"\n      | \"maxWidth\"\n      | \"placement\"\n      | \"trigger\"\n      | \"fallbackPlacements\"\n      | \"popperOptions\"\n    >,\n    Omit<React.ComponentProps<typeof MenuConfigProvider>, \"children\"> {\n  className?: string;\n\n  /**\n   * Close menu automatically when a `MenuItem` is clicked\n   *\n   * @default true\n   */\n  closeOnMenuItemClick?: boolean;\n\n  /**\n   * Color to use for the selected state of a menu item. Hover state will be\n   * programatically calculated depending on the theme.\n   */\n  color?: ShadedColor;\n\n  style?: React.CSSProperties;\n}\n\n/**\n * Menu element\n */\nexport const Menu: React.FC<Props> = ({\n  children,\n  closeOnMenuItemClick = true,\n  color,\n  fallbackPlacements,\n  iconSize,\n  content,\n  popperOptions,\n  ...props\n}) => {\n  const instanceRef = React.useRef<\n    Parameters<\n      NonNullable<React.ComponentProps<typeof AbstractTooltip>[\"onCreate\"]>\n    >[0]\n  >();\n  const inheritedMenuItemClickListener = useMenuItemClickListener();\n  const inheritedIconSize = useMenuIconSize();\n\n  /**\n   * Callback to handle descendeant `MenuItem` clicks.\n   *\n   * When we have nested menus and toggle menus we might need to change how this\n   * behaves.\n   */\n  const onMenuItemClick = React.useCallback<React.MouseEventHandler>(\n    (event) => {\n      if (inheritedMenuItemClickListener) {\n        inheritedMenuItemClickListener(event);\n      }\n\n      if (closeOnMenuItemClick) {\n        instanceRef.current?.hide();\n      }\n    },\n    [closeOnMenuItemClick, inheritedMenuItemClickListener, instanceRef]\n  );\n\n  return (\n    <MenuConfigProvider color={color} iconSize={iconSize ?? inheritedIconSize}>\n      <TippyMenuStyles />\n      <AbstractTooltip\n        appendTo=\"parent\"\n        offset={[0, 2]}\n        onCreate={(instance) => {\n          instanceRef.current = instance;\n        }}\n        content={\n          <MenuItemClickListenerProvider onClick={onMenuItemClick}>\n            {content}\n          </MenuItemClickListenerProvider>\n        }\n        hideOnClick\n        theme=\"space-kit-menu\"\n        trigger=\"mousedown\"\n        popperOptions={{\n          strategy: \"fixed\",\n          ...popperOptions,\n          modifiers: [\n            // Disable `flip` because we're using our new version\n            { name: \"flip\", enabled: false },\n            {\n              name: \"findTippyBox\",\n              phase: \"read\",\n              enabled: true,\n              fn({ name, state }) {\n                const element = state.elements.popper.querySelector<\n                  HTMLElement\n                >(\".tippy-box\");\n\n                state.modifiersData[name].boxElement = element;\n              },\n            },\n            sizeModifier,\n            {\n              name: \"maxSize\",\n              requires: [\"findTippyBox\"],\n              options: { padding: 7, fallbackPlacements },\n            },\n            {\n              name: \"applyMaxSize\",\n              enabled: true,\n              phase: \"beforeWrite\",\n              requires: [\"maxSize\", \"findTippyBox\"],\n              fn({ state }) {\n                const maxHeight = state.modifiersData.maxSize.height;\n\n                /**\n                 * We read this element in the `findTippyBox` phase. We need to\n                 * use some custom logic here to apply the style to the tippy\n                 * box because usually that's not made available. We _could_\n                 * apply these styles directly to the `popper` element and, but\n                 * then the border will be swallowed by the overflow. If we put\n                 * the border on `popper`, then the border will not be animated\n                 * because animations are applied to `.tippy-box`.\n                 */\n                const element: HTMLElement | null =\n                  state.modifiersData.findTippyBox.boxElement;\n\n                if (element) {\n                  element.style.maxHeight = `${maxHeight}px`;\n                  element.style.overflow = \"auto\";\n                }\n              },\n            },\n            // Modifiers later in the list override modifiers earlier in the\n            // list, so we have to place this at the end so user-defined\n            // modifiers can override space kit defined modifier configurations.\n            ...(popperOptions?.modifiers || []),\n          ],\n        }}\n        {...props}\n        interactive\n      >\n        {children}\n      </AbstractTooltip>\n    </MenuConfigProvider>\n  );\n};\n"],"names":["React","useMenuItemClickListener","useMenuIconSize","MenuConfigProvider","TippyMenuStyles","AbstractTooltip","MenuItemClickListenerProvider","sizeModifier"],"mappings":"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"}